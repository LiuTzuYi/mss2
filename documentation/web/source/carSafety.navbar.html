<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <base href="../">
    <title>JSDoc: source : navbar.js</title>
    <link href="css/prettify-tomorrow.css" type="text/css" rel="stylesheet">
    <link href="css/site.css" type="text/css" rel="stylesheet">
    <link href="css/custom.css" type="text/css" rel="stylesheet">
  </head>
  <body ng-app>
    <nav id="toc">
      <div class="sidenav-search">
      <input placeholder="Filter" id="filter-input" class="col12 block field" type="text">
      </div>
      <div class="nav-wrapper">
      <h2><a href="index.html">Home</a></h2>
      <ul class="module">
        <!-- undefined -->
        <li id="undefined" ng-hide="moduleundefined">
          <ul class="group">
            <h2 class="nav-group">
              <a href ng-click="undefinedModule = !undefinedModule">
                Module
              </a>
              <i ng-cloak ng-show="undefinedModule">+</i>
            </h2>
            <ul ng-hide="undefinedModule">
              <li>
                <a href="carSafety.html">carSafety</a>
              </li>
            </ul>
          </ul>
        </li>
      </ul><ul class="module">
        <!-- car_afety -->
        <h2 class="module">
          <a chref ng-click="modulecar_afety = !modulecar_afety">
            module: carSafety
          </a>
          <i ng-cloak ng-show="modulecar_afety">+</i>
        </h2>
        <li id="carSafety" ng-hide="modulecar_afety">
          <ul class="group">
            <h2 class="nav-group">
              <a href ng-click="car_afetyController = !car_afetyController">
                Controller
              </a>
              <i ng-cloak ng-show="car_afetyController">+</i>
            </h2>
            <ul ng-hide="car_afetyController">
              <li>
                <a href="carSafety.adminpanelloginCtrl.html">adminpanelloginCtrl</a>
              </li><li>
                <a href="carSafety.adminpanelnavCtrl.html">adminpanelnavCtrl</a>
              </li><li>
                <a href="carSafety.apcompanyaddCtrl.html">apcompanyaddCtrl</a>
              </li><li>
                <a href="carSafety.apcompanyeditCtrl.html">apcompanyeditCtrl</a>
              </li><li>
                <a href="carSafety.apcompanylistCtrl.html">apcompanylistCtrl</a>
              </li><li>
                <a href="carSafety.apdeviceaddCtrl.html">apdeviceaddCtrl</a>
              </li><li>
                <a href="carSafety.apdeviceeditCtrl.html">apdeviceeditCtrl</a>
              </li><li>
                <a href="carSafety.apdevicelistCtrl.html">apdevicelistCtrl</a>
              </li><li>
                <a href="carSafety.apdrvcardaddCtrl.html">apdrvcardaddCtrl</a>
              </li><li>
                <a href="carSafety.apdrvcardlogCtrl.html">apdrvcardlogCtrl</a>
              </li><li>
                <a href="carSafety.apmailnotifyaddCtrl.html">apmailnotifyaddCtrl</a>
              </li><li>
                <a href="carSafety.apmailnotifyeditCtrl.html">apmailnotifyeditCtrl</a>
              </li><li>
                <a href="carSafety.apmailnotifylistCtrl.html">apmailnotifylistCtrl</a>
              </li><li>
                <a href="carSafety.autologinCtrl.html">autologinCtrl</a>
              </li><li>
                <a href="carSafety.companyProfileCtrl.html">companyProfileCtrl</a>
              </li><li>
                <a href="carSafety.404Ctrl.html">404Ctrl</a>
              </li><li>
                <a href="carSafety.dashCtrl.html">dashCtrl</a>
              </li><li>
                <a href="carSafety.deviceSetCtrl.html">deviceSetCtrl</a>
              </li><li>
                <a href="carSafety.drivergrpProfileCtrl.html">drivergrpProfileCtrl</a>
              </li><li>
                <a href="carSafety.drivergrpSetCtrl.html">drivergrpSetCtrl</a>
              </li><li>
                <a href="carSafety.driverProfileCtrl.html">driverProfileCtrl</a>
              </li><li>
                <a href="carSafety.driverSetCtrl.html">driverSetCtrl</a>
              </li><li>
                <a href="carSafety.forgetPwdCtrl.html">forgetPwdCtrl</a>
              </li><li>
                <a href="carSafety.helpCtrl.html">helpCtrl</a>
              </li><li>
                <a href="carSafety.liveLocationCtrl.html">liveLocationCtrl</a>
              </li><li>
                <a href="carSafety.liveMonitorCtrl.html">liveMonitorCtrl</a>
              </li><li>
                <a href="carSafety.loginCtrl.html">loginCtrl</a>
              </li><li>
                <a href="carSafety.mailNotifySetCtrl.html">mailNotifySetCtrl</a>
              </li><li>
                <a href="carSafety.orgchartSetCtrl.html">orgchartSetCtrl</a>
              </li><li>
                <a href="carSafety.resetPwdCtrl.html">resetPwdCtrl</a>
              </li><li>
                <a href="carSafety.rosterSetCtrl.html">rosterSetCtrl</a>
              </li><li>
                <a href="carSafety.tripDetailCtrl.html">tripDetailCtrl</a>
              </li><li>
                <a href="carSafety.tripDrvImportCtrl.html">tripDrvImportCtrl</a>
              </li><li>
                <a href="carSafety.tripSetCtrl.html">tripSetCtrl</a>
              </li><li>
                <a href="carSafety.updatePwdCtrl.html">updatePwdCtrl</a>
              </li><li>
                <a href="carSafety.userroleSetCtrl.html">userroleSetCtrl</a>
              </li><li>
                <a href="carSafety.userSetCtrl.html">userSetCtrl</a>
              </li><li>
                <a href="carSafety.vehiclegrpProfileCtrl.html">vehiclegrpProfileCtrl</a>
              </li><li>
                <a href="carSafety.vehiclegrpSetCtrl.html">vehiclegrpSetCtrl</a>
              </li><li>
                <a href="carSafety.vehicleProfileCtrl.html">vehicleProfileCtrl</a>
              </li><li>
                <a href="carSafety.vehicleSetCtrl.html">vehicleSetCtrl</a>
              </li><li>
                <a href="carSafety.warnExportCtrl.html">warnExportCtrl</a>
              </li><li>
                <a href="carSafety.warnvideoDownloadCtrl.html">warnvideoDownloadCtrl</a>
              </li>
            </ul>
          </ul><ul class="group">
            <h2 class="nav-group">
              <a href ng-click="car_afetyService = !car_afetyService">
                Service
              </a>
              <i ng-cloak ng-show="car_afetyService">+</i>
            </h2>
            <ul ng-hide="car_afetyService">
              <li>
                <a href="carSafety.alertBox.html">alertBox</a>
              </li><li>
                <a href="carSafety.formValidService.html">formValidService</a>
              </li><li>
                <a href="carSafety.httpSuccessCheck.html">httpSuccessCheck</a>
              </li><li>
                <a href="carSafety.langService.html">langService</a>
              </li><li>
                <a href="carSafety.profileService.html">profileService</a>
              </li><li>
                <a href="carSafety.refetchMapService.html">refetchMapService</a>
              </li><li>
                <a href="carSafety.responsiveCheck.html">responsiveCheck</a>
              </li>
            </ul>
          </ul><ul class="group">
            <h2 class="nav-group">
              <a href ng-click="car_afetyConfig = !car_afetyConfig">
                Config
              </a>
              <i ng-cloak ng-show="car_afetyConfig">+</i>
            </h2>
            <ul ng-hide="car_afetyConfig">
              <li>
                <a href="carSafety.angular-chart-js.html">angular-chart-js</a>
              </li><li>
                <a href="carSafety.angular-dynamic-locale.html">angular-dynamic-locale</a>
              </li><li>
                <a href="carSafety.angular-translate.html">angular-translate</a>
              </li><li>
                <a href="carSafety.angularjs.html">angularjs</a>
              </li><li>
                <a href="carSafety.angularjs-material.html">angularjs-material</a>
              </li><li>
                <a href="carSafety.block-ui.html">block-ui</a>
              </li><li>
                <a href="carSafety.ng-idle.html">ng-idle</a>
              </li><li>
                <a href="carSafety.state-transition.html">state-transition</a>
              </li><li>
                <a href="carSafety.ui-router.html">ui-router</a>
              </li>
            </ul>
          </ul><ul class="group">
            <h2 class="nav-group">
              <a href ng-click="car_afetyConstant = !car_afetyConstant">
                Constant
              </a>
              <i ng-cloak ng-show="car_afetyConstant">+</i>
            </h2>
            <ul ng-hide="car_afetyConstant">
              <li>
                <a href="carSafety.appConfig.html">appConfig</a>
              </li><li>
                <a href="carSafety.chartConfig.html">chartConfig</a>
              </li><li>
                <a href="carSafety.errorCodeConfig.html">errorCodeConfig</a>
              </li><li>
                <a href="carSafety.exportConfig.html">exportConfig</a>
              </li><li>
                <a href="carSafety.mapConfig.html">mapConfig</a>
              </li><li>
                <a href="carSafety.regexConfig.html">regexConfig</a>
              </li>
            </ul>
          </ul><ul class="group">
            <h2 class="nav-group">
              <a href ng-click="car_afetyDirective = !car_afetyDirective">
                Directive
              </a>
              <i ng-cloak ng-show="car_afetyDirective">+</i>
            </h2>
            <ul ng-hide="car_afetyDirective">
              <li>
                <a href="carSafety.bInfoWindow.html">bInfoWindow</a>
              </li><li>
                <a href="carSafety.bMarker.html">bMarker</a>
              </li><li>
                <a href="carSafety.bPolyline.html">bPolyline</a>
              </li><li>
                <a href="carSafety.bTrafficLayer.html">bTrafficLayer</a>
              </li><li>
                <a href="carSafety.convertToNumber.html">convertToNumber</a>
              </li><li>
                <a href="carSafety.customOnChange.html">customOnChange</a>
              </li><li>
                <a href="carSafety.fileInputImg.html">fileInputImg</a>
              </li><li>
                <a href="carSafety.multicheckListbox.html">multicheckListbox</a>
              </li><li>
                <a href="carSafety.navbar.html">navbar</a>
              </li><li>
                <a href="carSafety.pageSelect.html">pageSelect</a>
              </li><li>
                <a href="carSafety.showTooltipOnTextOverflow.html">showTooltipOnTextOverflow</a>
              </li><li>
                <a href="carSafety.stFiltered.html">stFiltered</a>
              </li><li>
                <a href="carSafety.stPersist.html">stPersist</a>
              </li><li>
                <a href="carSafety.stSelectDistinct.html">stSelectDistinct</a>
              </li><li>
                <a href="carSafety.virtualResize.html">virtualResize</a>
              </li>
            </ul>
          </ul><ul class="group">
            <h2 class="nav-group">
              <a href ng-click="car_afetyFilter = !car_afetyFilter">
                Filter
              </a>
              <i ng-cloak ng-show="car_afetyFilter">+</i>
            </h2>
            <ul ng-hide="car_afetyFilter">
              <li>
                <a href="carSafety.fixNum.html">fixNum</a>
              </li><li>
                <a href="carSafety.optionalFilter.html">optionalFilter</a>
              </li><li>
                <a href="carSafety.tableCustomFilter.html">tableCustomFilter</a>
              </li>
            </ul>
          </ul><ul class="group">
            <h2 class="nav-group">
              <a href ng-click="car_afetyRun = !car_afetyRun">
                Run
              </a>
              <i ng-cloak ng-show="car_afetyRun">+</i>
            </h2>
            <ul ng-hide="car_afetyRun">
              <li>
                <a href="carSafety.state-transition-init.html">state-transition-init</a>
              </li>
            </ul>
          </ul>
        </li>
      </ul>
      </div>
    </nav>
    <div id="content" class="page-wrap">
      <h1 class="title">
        source : navbar.js
      </h1>
      <div id="main" class="big-container">
        <!-- source code html -->
        <article>
          <pre class="prettyprint source linenums"><code>/*
* @Author: Zilvia Kam
* @Date:   2019-04-04 17:39:31
* @Last Modified by:   Zilvia Kam
* @Last Modified time: 2019-10-08 11:28:42
*/
'use strict';
/**
 * @memberof carSafety
 * @ngdoc Directive
 * @name navbar
 * @restrict E
 * @description
 *   Navigation bar component
 *
 * @example
 * &lt;navbar>&lt;/navbar>
 */
angular.module('carSafety').directive('navbar', ['$document','$state','$http', 'Idle', 'Keepalive', 'appConfig', 'httpSuccessCheck', '$translate', 'alertBox', '$stateParams', '$location', '$timeout', 'regexConfig', function($document, $state,$http, Idle, Keepalive, appConfig, httpSuccessCheck, $translate, alertBox, $stateParams, $location, $timeout, regexConfig) {
    return {
        restrict: 'E',
        templateUrl: '../../view/component/navbar.html',
        replace: true,
        scope: true,
        link: function(scope, element, attrs) {
            scope.dataCoVer = {
                crtyear: new Date().getFullYear(),
                version: appConfig.version
            }
            scope.typeOldPwd="password";
            scope.typeNewPwd="password";
            scope.typeConPwd="password";
            scope.navbarSm=false;
            scope.navbarUser=false;
            scope.showChangePwd=false;
            scope.pwdSetting = scope.$parent.userInfo.pwdSetting
            scope.passwordmin = scope.pwdSetting.char
            scope.passwordregex = regexConfig['passwordregex_'+scope.pwdSetting.type];
            scope.current = $state.current.name;
            scope.userdepartment = scope.$parent.userInfo.department
            scope.menu = angular.copy(appConfig.navigateMenu);
            var blockUi = angular.element(document.getElementsByTagName("BODY")[0]);
            scope.confirmpwregex = "";
            scope.newconfirmregex = function(str){
                scope.confirmpwregex = "";
                var symbol = new RegExp(regexConfig.symbolregex)
                var len = str.length;
                for (var i = 0; i &lt; len; i++) {
                    if(symbol.test(str[i])){
                        scope.confirmpwregex += "\\"+str[i];
                    }
                    else{
                        scope.confirmpwregex += str[i];
                    }
                }
            }
            scope.hasCurrent = function(list){
                var match = false
                for (var i = 0; i &lt; list.length; i++) {
                    if(scope.current==list[i].path){
                        match = true
                        break;
                    }
                }
                return match
            }
            scope.navchildaccess = function(access){
                var set = false;
                for(var i=0;i&lt;access.length;i++){
                    if(scope.$parent.permission.indexOf(access[i])!==-1){
                        set = true;
                        break;
                    }
                }
                return set;
            }
            scope.hideDropsm = function(){
                for (var i = 0; i&lt;scope.menu.length; i++) {
                    if(scope.menu[i].show){
                        scope.menu[i].show=false;
                    }
                }
            }
            scope.hideAlldrop = function(){
                for (var i = 0; i&lt;scope.menu.length; i++) {
                    if(scope.menu[i].show){
                        scope.menu[i].show=false;
                    }
                    var dropdown = document.getElementById("navbardroptag"+i);
                    if(dropdown){
                        dropdown.classList.remove("show");
                    }
                    var dropdownlist = document.getElementById("navbardroplist"+i);
                    if(dropdownlist){
                        dropdownlist.classList.remove("show");
                    }
                }
            }
            scope.shNavsmdrop = function(num){
                if(scope.menu[num].show==true){
                    scope.hideDropsm();
                }
                else{
                    scope.hideDropsm();
                    scope.menu[num].show=!scope.menu[num].show;
                }
            };
            scope.shNavsm = function(){
                scope.hideDropsm();
                scope.navbarUser = false;
                scope.showChangePwd=false;
                scope.navbarSm = !scope.navbarSm;
            };
            scope.shUser = function(){
                scope.hideAlldrop();
                scope.navbarSm=false;
                scope.showChangePwd=false;
                scope.navbarUser = !scope.navbarUser;
                delete scope.oldPW
                delete scope.newPW
                delete scope.conPW
                delete scope.oldPWC
                delete scope.newPWC
                delete scope.conPWC
            };
            scope.hideOthertab = function(num){
                var profilelist = document.querySelector(".profile-listdata>.multiselect-parent>ul");
                if(profilelist&&profilelist.style.display=='block'){
                    $timeout(function() {
                        angular.element(document.querySelector(".profile-listdata>.multiselect-parent>div")).triggerHandler('click');
                    })
                }
                scope.shNavsmdrop(num);
                scope.navbarUser = false;
                scope.navbarSm=false;
                scope.showChangePwd=false;
            };
            scope.shChangePwd = function(){
                scope.showChangePwd=!scope.showChangePwd;
                delete scope.oldPW
                delete scope.newPW
                delete scope.conPW
                delete scope.oldPWC
                delete scope.newPWC
                delete scope.conPWC
            };
            scope.shPreference = function(){
                scope.showChangePwd=false;
            };
            element.bind('click', function(event) {
                //event.stopPropagation();
                var profilelist = document.querySelector(".profile-listdata>.multiselect-parent>ul");
                if(profilelist&&profilelist.style.display=='block'){
                    $timeout(function() {
                        angular.element(document.querySelector(".profile-listdata>.multiselect-parent>div")).triggerHandler('click');
                    })
                }
                if(event.target.id=='NAVBAR'||event.target.id=='lang-select'){
                    scope.navbarUser = false;
                    scope.navbarSm=false;
                    scope.showChangePwd=false;
                    scope.$apply();
                    scope.hideAlldrop();
                }
                if(event.target.classList.contains('dropdown')==false&&event.target.classList.contains('dropdown-toggle')==false){
                    event.stopPropagation();
                }
            });
            $document.bind('click', function(event){
                if(event.target.classList.contains('dropdown')==false&&event.target.classList.contains('dropdown-toggle')==false&&event.target.classList.contains('updatepw-alert')==false){
                    scope.navbarUser = false;
                    scope.navbarSm=false;
                    scope.showChangePwd=false;
                    scope.$apply();
                    scope.hideAlldrop();
                }
                else if(event.target.classList.contains('dropdown-toggle')&&event.target.classList.contains('profile-list-select')&&event.target.classList.contains('updatepw-alert')==false){
                    scope.navbarUser = false;
                    scope.navbarSm=false;
                    scope.showChangePwd=false;
                    scope.$apply();
                    scope.hideAlldrop();
                }
            });
            scope.toLogout = function(){
                var func =  function(result){
                    Idle.unwatch();
                    window.location.href = "/"+$stateParams.company_code+"/login"
                    //$state.go('login', {}, { reload: true })
                }
                $http({
                    method: 'GET',
                    url: '/api/logout'
                }).then(function successCallback(response) {
                    blockUi.removeClass('block-ui-active block-ui-visible')
                    var errorphp = httpSuccessCheck.checkHttp(response)
                    if(errorphp){
                        alertBox.errorAlert('90003_01',func)
                    }
                    else{
                        Idle.unwatch();
                        window.location.href = "/"+$stateParams.company_code+"/login"
                        //$state.go('login', {}, { reload: true })
                    }
                }, function errorCallback(response) {
                    blockUi.removeClass('block-ui-active block-ui-visible')
                    var errorphp = httpSuccessCheck.checkerrorHttp(response)
                    if(errorphp){
                        alertBox.errorAlert('90003_'+errorphp,func)
                    }
                });
            };
            scope.toDash = function(){
                $state.go('dash', {}, { reload: true })
            };
            scope.toPage = function(path){
                window.scrollTo(0,0)
                $state.go(path, {}, { reload: true })
            }
            scope.toHelp = function(){
                var anchor = $state.current.name
                var url
                if(anchor=='liveLocation'){
                    url = $state.href('help.'+scope.$parent.lang, {'#': anchor});
                }
                else if(anchor.includes("Profile")){
                    anchor = 'profile'
                    url = $state.href('help.'+scope.$parent.lang, {'#': anchor});
                }
                else if(anchor.includes("trip")||anchor.includes("warn")){
                    anchor = 'warning'
                    url = $state.href('help.'+scope.$parent.lang, {'#': anchor});
                }
                else if(anchor.includes("Set")){
                    anchor = 'setting'
                    url = $state.href('help.'+scope.$parent.lang, {'#': anchor});
                }
                else{
                    url = $state.href('help.'+scope.$parent.lang);
                }
                window.open(url,'_blank');
            }
            scope.supportAlert = function(){
                alertBox.supportAlert(appConfig.support);
            }
            scope.updatePw = function (){
                var postdata = {
                    password: scope.oldPW,
                    newpassword: scope.newPW
                }
                $http({
                    method: 'POST',
                    url: '/api/updatepw',
                    data: postdata
                }).then(function successCallback(response) {
                    blockUi.removeClass('block-ui-active block-ui-visible')
                    var errorphp = httpSuccessCheck.checkHttp(response)
                    if(errorphp){
                        alertBox.updatepwAlert('90005_01')
                    }
                    else{
                        scope.shUser()
                        alertBox.titleAlert('success','pweditSuccess')
                    }
                }, function errorCallback(response) {
                    blockUi.removeClass('block-ui-active block-ui-visible')
                    var errorphp = httpSuccessCheck.checkerrorHttp(response)
                    if(errorphp){
                        alertBox.updatepwAlert('90005_'+errorphp)
                    }
                    else{
                        alertBox.updatepwAlert(response.data.code)
                    }
                });
            }
            scope.inputPW = function(str,pw){
                scope[str] = pw;
                scope[str+'C'] = true;
                if(str=='newPW'){
                    scope.newconfirmregex(pw)
                }
            }
            scope.checkPW = function(str){
                scope[str] = true;
            }
        }
    };
}]);
</code></pre>
        </article>
        <!-- index.html -->
        <!-- class files -->
      </div>
      <footer style="clear:both">
        Documentation generated by
        <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a>
        using
        <a href="https://github.com/allenhwkim/angular-jsdoc">Angular-JSDoc template</a>
      </footer>
    </div>
    <script src="js/prettify.js"></script>
    <script src="js/angular.min.js"></script>
    <script src="js/site.js"></script>
    <!--%= prettyJson %-->
    <script>
      prettyPrint();
      var lineNo = window.location.hash.match(/#line([0-9]+)$/);
      lineNo && document.querySelector("ol li:nth-child("+(lineNo[1])+")").scrollIntoView();
    </script>
  </body>
</html>